<!DOCTYPE html>
<html lang="es" data-bs-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Mi Blog Dark Anime</title>

<!-- BOOTSTRAP -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<style>
/* -------------------- */
/* PALETA ANIME LAVANDA */
/* -------------------- */
:root {
    --bs-body-bg: #0A1228;
    --bs-body-color: #E8ECF9;

    --bs-primary: #A39ACB;
    --bs-primary-rgb: 163,154,203;

    --bs-secondary: #9DA2C8;
    --bs-secondary-rgb: 157,162,200;

    --bs-dark: #1B1E24;
    --bs-dark-rgb: 27,30,36;

    --bs-border-color: #2F333D;

    --bs-card-bg: #1B1E24;
    --bs-card-border-color: #2F333D;
}

/* Global */
body {
    background: #0A1228;
    color: var(--bs-body-color);
    font-family: "Roboto", sans-serif;
}

/* Section titles */
.section-title {
    border-left: 5px solid var(--bs-primary);
    padding-left: 12px;
    margin-top: 50px;
    margin-bottom: 20px;
    font-size: 1.6rem;
}

/* Cards */
.card {
    background: var(--bs-card-bg);
    border: 1px solid var(--bs-border-color);
    border-radius: 12px;
    overflow: hidden;
    transition: 0.2s ease;
}
.card:hover {
    transform: translateY(-6px);
    border-color: var(--bs-primary);
    box-shadow: 0px 0px 12px rgba(163,154,203,0.4);
}
.card img {
    object-fit: cover;
    height: 180px;
}

/* Main video */
.main-video iframe {
    width: 100%;
    height: 420px;
    border-radius: 12px;
}

/* --- MODAL ANIME PREMIUM --- */
.modal-content {
    background: #101626 !important;
    border: 1px solid #A39ACB !important;
    border-radius: 16px !important;
    box-shadow: 0px 0px 20px rgba(163,154,203,0.4);
}

.modal-header {
    border-bottom: 1px solid rgba(163,154,203,0.3);
}

.modal-body {
    padding: 20px 30px;
}

#modal-img {
    width: 100%;
    max-width: 320px;
    border-radius: 14px;
    box-shadow: 0px 0px 12px rgba(0,0,0,0.5);
    border: 2px solid rgba(163,154,203,0.4);
}

.modal-title {
    font-size: 1.4rem;
    font-weight: bold;
    color: #A39ACB;
}

#modal-categorias {
    margin-bottom: 10px;
    color: #9DA2C8;
    font-size: 0.9rem;
}

#modal-desc {
    line-height: 1.5;
    color: #E8ECF9;
}

.btn-anime-primary {
    background: #A39ACB;
    color: #0A1228;
    font-weight: bold;
    border: none;
    transition: 0.2s;
}
.btn-anime-primary:hover {
    background: #c5bef1;
    box-shadow: 0px 0px 12px rgba(163,154,203,0.7);
}

.btn-anime-secondary {
    background: #2f333d;
    color: #E8ECF9;
    font-weight: bold;
    border: 1px solid #A39ACB;
}
.btn-anime-secondary:hover {
    background: #3c404b;
    box-shadow: 0px 0px 8px rgba(163,154,203,0.4);
}

/* Dropdown menu anime */
.dropdown-menu {
    background: var(--bs-dark);
    border: 1px solid var(--bs-border-color);
    padding: 12px;
}
.dropdown-item input {
    margin-right: 8px;
}
</style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
  <a class="navbar-brand fw-bold" href="#">MiBlog</a>

  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navMenu">
    <ul class="navbar-nav ms-auto">
      <li class="nav-item"><a class="nav-link" href="#">Inicio</a></li>
      <li class="nav-item"><a class="nav-link" href="#videos">Videos</a></li>
      <li class="nav-item"><a class="nav-link" href="#mods">Mods</a></li>
      <li class="nav-item"><a class="nav-link" href="#contacto">Contacto</a></li>
    </ul>
  </div>
</nav>

<!-- CONTENIDO -->
<div class="container-fluid py-4">

    <!-- SECCIÓN: MÁS POPULAR -->
    <h2 class="section-title">Más popular</h2>
    <div class="main-video mb-4">
        <iframe id="popular-video" src="" allowfullscreen></iframe>
        <h3 id="popular-title" class="mt-3">Cargando...</h3>
        <p id="popular-desc" class="text-secondary">Obteniendo el video más visto...</p>
    </div>

    <!-- ÚLTIMOS VIDEOS -->
    <h2 class="section-title" id="videos">Últimos videos</h2>
    <div id="youtube-feed" class="row g-4">
        <p>Cargando videos...</p>
    </div>

    <!-- MODS -->
    <h2 class="section-title" id="mods">Mods</h2>

    <!-- Dropdown filtros -->
    <div class="dropdown mb-3">
      <button class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown">
        Filtrar por categoría
      </button>

      <div class="dropdown-menu" id="mods-dropdown"></div>
    </div>

    <!-- GRID DE MODS -->
    <div class="row g-4" id="mods-section">
        <p>Cargando mods...</p>
    </div>
</div>

<!-- FOOTER -->
<footer class="text-center py-4 mt-5 bg-dark">
    © 2025 - Mi Blog Anime Dark · Todos los derechos reservados
</footer>

<!-- MODAL DE MODS -->
<div class="modal fade" id="modModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 id="modal-title" class="modal-title"></h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <div class="row g-4">

          <!-- IMAGEN -->
          <div class="col-12 col-md-5 text-center">
            <img id="modal-img" src="">
          </div>

          <!-- INFO -->
          <div class="col-12 col-md-7">
            <p id="modal-categorias"></p>
            <p id="modal-desc"></p>

            <a id="modal-video" target="_blank" class="btn btn-anime-primary w-100 mb-2">
              Ver Video
            </a>

            <a id="modal-download" target="_blank" class="btn btn-anime-secondary w-100">
              Descargar Mod
            </a>
          </div>

        </div>
      </div>

    </div>
  </div>
</div>


<!-- YOUTUBE API -->
<script>
const API_KEY = "AIzaSyAykSooDgAmuarzGPPyl8bygkR7T5pIPss";
const CHANNEL_ID = "UCG_Oh0Ty-spxPukCEvfXWjQ";

async function cargarUltimosVideos() {
    const url = 
    `https://www.googleapis.com/youtube/v3/search?key=${API_KEY}&channelId=${CHANNEL_ID}&part=snippet,id&order=date&maxResults=3`;

    const resp = await fetch(url);
    const data = await resp.json();

    const cont = document.getElementById("youtube-feed");
    cont.innerHTML = "";

    data.items.forEach(item => {
        if (item.id.videoId) {
            cont.innerHTML += `
            <div class="col-12 col-md-6 col-lg-4">
              <div class="card h-100">
                <img src="${item.snippet.thumbnails.high.url}" class="card-img-top">
                <div class="card-body">
                  <h5 class="card-title">${item.snippet.title}</h5>
                  <p class="card-text text-secondary">${item.snippet.description.substring(0,100)}...</p>
                  <a class="btn btn-primary" target="_blank" href="https://www.youtube.com/watch?v=${item.id.videoId}">Ver video</a>
                </div>
              </div>
            </div>`;
        }
    });
}

async function cargarPopular() {
    const url = 
    `https://www.googleapis.com/youtube/v3/search?key=${API_KEY}&channelId=${CHANNEL_ID}&part=snippet,id&order=viewCount&maxResults=1`;

    const resp = await fetch(url);
    const data = await resp.json();
    const item = data.items[0];

    document.getElementById("popular-video").src =
        `https://www.youtube.com/embed/${item.id.videoId}`;

    document.getElementById("popular-title").innerText = item.snippet.title;
    document.getElementById("popular-desc").innerText = item.snippet.description.substring(0,200);
}

cargarUltimosVideos();
cargarPopular();
</script>

<!-- SISTEMA DE MODS -->
<script>
let mods = [];
let categorias = new Set();
let filtros = new Set();

async function cargarMods() {
    const resp = await fetch("mods.json");
    mods = await resp.json();

    // Categorías
    mods.forEach(m => m.categorias.forEach(c => categorias.add(c)));
    generarDropdown();
    renderMods();
}

function generarDropdown() {
    const dd = document.getElementById("mods-dropdown");
    dd.innerHTML = `
        <label class="dropdown-item">
            <input type="checkbox" value="ALL" onchange="toggleFiltro(this)"> Mostrar todos
        </label>
        <hr class="dropdown-divider">
    `;

    categorias.forEach(cat => {
        dd.innerHTML += `
        <label class="dropdown-item">
            <input type="checkbox" value="${cat}" onchange="toggleFiltro(this)"> ${cat}
        </label>`;
    });
}

function toggleFiltro(chk) {
    if (chk.value === "ALL") {
        filtros.clear();
        renderMods();
        document.querySelectorAll('#mods-dropdown input').forEach(i => i.checked = false);
        return;
    }

    if (chk.checked) filtros.add(chk.value);
    else filtros.delete(chk.value);

    renderMods();
}

function renderMods() {
    const cont = document.getElementById("mods-section");
    cont.innerHTML = "";

    let lista = mods;

    if (filtros.size > 0) {
        lista = mods.filter(m => 
            [...filtros].every(f => m.categorias.includes(f))
        );
    }

    if (lista.length === 0) {
        cont.innerHTML = "<p>No hay mods con esas categorías.</p>";
        return;
    }

    lista.forEach(m => {
        cont.innerHTML += `
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card h-100" onclick="abrirModal('${m.name}')">
            <img src="${m.thumbnail}" class="card-img-top">
            <div class="card-body">
              <h5 class="card-title">${m.name}</h5>
              <p class="card-text text-secondary">${m.desc.substring(0,100)}...</p>
            </div>
          </div>
        </div>`;
    });
}

function abrirModal(nombre) {
    const m = mods.find(x => x.name === nombre);

    document.getElementById("modal-img").src = m.imagen_mod || m.thumbnail;
    document.getElementById("modal-title").innerText = m.name;
    document.getElementById("modal-categorias").innerText = "Categorías: " + m.categorias.join(", ");
    document.getElementById("modal-desc").innerText = m.desc;
    document.getElementById("modal-video").href = m.video;
    document.getElementById("modal-download").href = m.mod;

    const modal = new bootstrap.Modal(document.getElementById("modModal"));
    modal.show();
}

cargarMods();
</script>

</body>
</html>